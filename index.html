<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solklick</title>
  <style>
    :root {
      --cell: 64;
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      background: #000;
      overflow: hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Emoji, Noto Color Emoji, Apple Color Emoji, sans-serif;
    }

    .canvas {
      position: relative;
      width: 100vw;
      height: 100vh;
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }

    .sun {
      position: absolute;
      transform: translate(-50%, -50%);
      line-height: 1;
      pointer-events: none;
      filter: drop-shadow(0 0 6px rgba(255, 210, 0, 0.35));
    }
  </style>
</head>
<body>
  <div class="canvas" id="canvas" aria-label="Klicka för att placera en sol"></div>

  <script>
    (function () {
      const canvas = document.getElementById('canvas');
      const cell = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--cell'));

      function snapToGrid(x, y) {
        const col = Math.floor(x / cell);
        const row = Math.floor(y / cell);
        const cx = col * cell + cell / 2;
        const cy = row * cell + cell / 2;
        return { x: cx, y: cy };
      }

      function placeSun(clientX, clientY) {
        const rect = canvas.getBoundingClientRect();
        const x = clientX - rect.left;
        const y = clientY - rect.top;
        const { x: sx, y: sy } = snapToGrid(x, y);

        const span = document.createElement('span');
        span.className = 'sun';
        span.style.fontSize = Math.round(cell * 0.8) + 'px';
        span.style.left = sx + 'px';
        span.style.top = sy + 'px';
        span.textContent = '☀️';
        canvas.appendChild(span);
      }

      canvas.addEventListener('click', (e) => {
        placeSun(e.clientX, e.clientY);
      });

      canvas.addEventListener('touchstart', (e) => {
        const t = e.touches[0];
        if (!t) return;
        placeSun(t.clientX, t.clientY);
      }, { passive: true });

      // Rensa allt med R
      window.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'r') canvas.innerHTML = '';
      });
    })();
  </script>
</body>
</html>
