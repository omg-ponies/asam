<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Always Summer</title>
  <style>
    :root {
      --cell: 64;
      --lightness: 0; /* start helt mörkt */
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      /* Start helt svart, ljusna gradvis mot nordisk soluppgång */
      background: linear-gradient(
        to bottom,
        hsl(0, 0%, calc(0% + var(--lightness) * 0.2%)),   /* svart -> lite blåton */
        hsl(220, 40%, calc(0% + var(--lightness) * 0.4%)), /* midnattsblå blir ljusare */
        hsl(200, 60%, calc(0% + var(--lightness) * 0.6%)), /* kall blå/grå */
        hsl(40, 80%, calc(0% + var(--lightness) * 0.8%))   /* varmt gult vid horisonten */
      );
      overflow: hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Emoji, Noto Color Emoji, Apple Color Emoji, sans-serif;
      transition: background 1s ease;
    }

    .canvas {
      position: relative;
      width: 100vw;
      height: 100vh;
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }

    .sun {
      position: absolute;
      transform: translate(-50%, -50%);
      line-height: 1;
      pointer-events: none;
      filter: drop-shadow(0 0 6px rgba(255, 210, 0, 0.35));
    }
  </style>
</head>
<body>
  <div class="canvas" id="canvas" aria-label="Klicka för att placera en sol"></div>

  <script>
    (function () {
      const canvas = document.getElementById('canvas');
      const cell = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--cell'));
      let lightness = 0; // hur ljust det är, max 100

      function updateBackground() {
        document.documentElement.style.setProperty('--lightness', lightness);
      }

      function snapToGrid(x, y) {
        const col = Math.floor(x / cell);
        const row = Math.floor(y / cell);
        const cx = col * cell + cell / 2;
        const cy = row * cell + cell / 2;
        return { x: cx, y: cy };
      }

      function placeSun(clientX, clientY) {
        const rect = canvas.getBoundingClientRect();
        const x = clientX - rect.left;
        const y = clientY - rect.top;
        const { x: sx, y: sy } = snapToGrid(x, y);

        const span = document.createElement('span');
        span.className = 'sun';
        span.style.fontSize = Math.round(cell * 0.8) + 'px';
        span.style.left = sx + 'px';
        span.style.top = sy + 'px';
        span.textContent = '☀️';
        canvas.appendChild(span);

        // Gör bakgrunden lite ljusare
        if (lightness < 100) {
          lightness += 5; // öka 5 per sol
          if (lightness > 100) lightness = 100;
          updateBackground();
        }
      }

      canvas.addEventListener('click', (e) => {
        placeSun(e.clientX, e.clientY);
      });

      canvas.addEventListener('touchstart', (e) => {
        const t = e.touches[0];
        if (!t) return;
        placeSun(t.clientX, t.clientY);
      }, { passive: true });

      window.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'r') {
          canvas.innerHTML = '';
          lightness = 0;
          updateBackground();
        }
      });

      updateBackground();
    })();
  </script>
</body>
</html>
